<!DOCTYPE html>
<html lang="fr">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>Pongame</title>
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css" rel="stylesheet">
	<link rel="stylesheet" href="style.css">
	<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
	<script src="script.js" defer></script>
 
</head>
<body>
	<!-- Barre du haut -->
	<nav id="navbar" class="navbar navbar-expand">
		<div class="container-fluid">
			<a id="home-btn" class="navbar-brand text-white" href="#">PONGAME</a>
		</div>
	</nav>


    <!-- Conteneur principal pour les sections de contenu -->
    <div id="game" class=" container-fluid d-flex justify-content-center align-items-center" style="height: 100vh; padding-top: 50px;">
        <div class="terrain position-relative">
			<div class="balle position-absolute"></div>
			<div class="raquette-gauche position-absolute"></div>
    		<div class="raquette-droite position-absolute"></div>
		</div>
    </div>

	<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
	<script>


      // Fonction pour envoyer une commande de déplacement au backend
    function moveRaquette(player, direction) {
        fetch('http://127.0.0.1:5000/api/move_raquette', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ player, direction }),
        })
        .then(response => response.json())
        .then(data => {
            updateRaquettes(data.game_state); // Met à jour les positions sur le frontend
        })
        .catch(error => console.error('Erreur:', error));
    }

    // Fonction pour mettre à jour les positions des raquettes
    function updateRaquettes(state) {
        const raquetteGauche = document.querySelector('.raquette-gauche');
        const raquetteDroite = document.querySelector('.raquette-droite');

        raquetteGauche.style.top = `${state.raquette_gauche.y}%`;
        raquetteDroite.style.top = `${state.raquette_droite.y}%`;
    }

    // Gestion des touches clavier pour déplacer les raquettes
    document.addEventListener('keydown', (event) => {
        // Raquette gauche (W / S)
        if (event.key === 'w') moveRaquette('gauche', 'up');
        if (event.key === 's') moveRaquette('gauche', 'down');

        // Raquette droite (Flèche Haut / Flèche Bas)
        if (event.key === 'ArrowUp') moveRaquette('droite', 'up');
        if (event.key === 'ArrowDown') moveRaquette('droite', 'down');
    });

    // Synchroniser régulièrement l'état des raquettes
    setInterval(() => {
        fetch('http://127.0.0.1:5000/api/game_state')
            .then(response => response.json())
            .then(data => updateRaquettes(data))
            .catch(error => console.error('Erreur:', error));
    }, 50); // Toutes les 50ms
	</script>
</body>
</html>
